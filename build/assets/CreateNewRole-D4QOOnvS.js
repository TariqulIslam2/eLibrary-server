import{k as I,r as c,A as N,j as e}from"./index-BnTmYUkP.js";import{u as M}from"./index.esm-CJb1F2Ko.js";import{a as u,b as p}from"./api-wfLvVcRq.js";import{C as R,a as F}from"./CRow-DtjUj6WL.js";import{S as y}from"./index-ClsgFobk.js";import{a as C}from"./cil-lock-locked-Df1Z1tUn.js";import"./AntdIcon-ZEkvb8A9.js";import"./compact-item-BqMqF4CM.js";const V=()=>{const{register:E,reset:D,handleSubmit:j,formState:{errors:n}}=M(),b=I(),[S,_]=c.useState([]),[l,L]=c.useState(),[d,o]=c.useState([]),h=N();c.useEffect(()=>{u.get(`${p}/admistration/module`).then(t=>_(t.data.data)).catch(t=>alert(t.message))},[]),c.useEffect(()=>{if(l){const t=JSON.parse(sessionStorage.getItem("subModuleData"))||[],a=t.filter(s=>s.MODULE_MST_ID===l);a.length>0?o(a):u.get(`${p}/admistration/submodule/${l}`).then(s=>{const r=s.data.data.map(x=>({...x,MODULE_MST_ID:l,VISIBLE_FLAG:!1,WRITE_FLAG:!1,EDIT_FLAG:!1,READ_FLAG:!1}));o(r);const m=[...t,...r];sessionStorage.setItem("subModuleData",JSON.stringify(m))}).catch(s=>{console.error("Error fetching submodule data:",s.message)})}},[l]);const f=(t,a)=>{const s=[...d];s[t]={...s[t],VISIBLE_FLAG:a,WRITE_FLAG:a,EDIT_FLAG:a,READ_FLAG:a},o(s),g(l,s)},i=(t,a,s)=>{const r=[...d];r[t][a]=s,o(r),g(l,r)},g=(t,a)=>{const m=[...(JSON.parse(sessionStorage.getItem("subModuleData"))||[]).filter(x=>x.MODULE_MST_ID!==t),...a];sessionStorage.setItem("subModuleData",JSON.stringify(m))},A=t=>{const a=JSON.parse(sessionStorage.getItem("subModuleData"))||[];t.array=a,t.USER_ID=h==null?void 0:h.employee_id,u.post(`${p}/admistration/roleaccesscreate`,t).then(s=>{D(),sessionStorage.removeItem("subModuleData"),o([]),b(-1)}).catch(s=>{console.error("Error submitting data:",s.message)})};return e.jsx("div",{children:e.jsxs("form",{onSubmit:j(A),children:[e.jsx(R,{children:e.jsxs(F,{xs:12,children:[e.jsxs("div",{className:"mb-1",children:[e.jsxs("label",{className:"form-label small",children:["Role Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${n.ROLE_NAME?"is-invalid":""}`,placeholder:"Role Name",...E("ROLE_NAME",{required:!0})}),e.jsx("div",{className:"invalid-feedback",children:n.ROLE_NAME&&"Please enter a role name."})]}),e.jsxs("div",{className:"mb-1",children:[e.jsxs("label",{className:"form-label small",children:["Role Description ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${n.ROLE_DESC?"is-invalid":""}`,placeholder:"Role Description",...E("ROLE_DESC",{required:!0})}),e.jsx("div",{className:"invalid-feedback",children:n.ROLE_DESC&&"Please enter a role description."})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{className:"form-label small",children:"Select Module"}),e.jsx(y,{showSearch:!0,placeholder:"Select a Module",className:"w-100",onChange:L,options:S.map(t=>({value:t.MODULE_MST_ID,label:t.MODULE_NAME}))})]}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{className:"text-start",children:"Sub Module"}),e.jsx("th",{children:"All"}),e.jsx("th",{children:"View"}),e.jsx("th",{children:"Write"}),e.jsx("th",{children:"Edit"}),e.jsx("th",{children:"Read"})]})}),e.jsx("tbody",{children:d.map((t,a)=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{className:"text-start",children:t.MODULE_DTL_NAME}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",style:{width:"25px",height:"25px"},checked:t.VISIBLE_FLAG&&t.WRITE_FLAG&&t.EDIT_FLAG&&t.READ_FLAG,onChange:s=>f(a,s.target.checked)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:t.VISIBLE_FLAG,style:{width:"25px",height:"25px"},onChange:s=>i(a,"VISIBLE_FLAG",s.target.checked)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:t.WRITE_FLAG,style:{width:"25px",height:"25px"},onChange:s=>i(a,"WRITE_FLAG",s.target.checked)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:t.EDIT_FLAG,style:{width:"25px",height:"25px"},onChange:s=>i(a,"EDIT_FLAG",s.target.checked)})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:t.READ_FLAG,style:{width:"25px",height:"25px"},onChange:s=>i(a,"READ_FLAG",s.target.checked)})})]},a))})]})]})]})}),e.jsx(C,{type:"submit",className:"mt-3",style:{backgroundColor:"#3C8DBC",color:"#fff"},children:"Save"})]})})};export{V as default};
