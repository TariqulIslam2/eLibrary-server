import{r as a,j as e}from"./index-DO-SV_97.js";import{a as d,b as n}from"./api-wfLvVcRq.js";import{l as S}from"./index-0c_p6BVy.js";import{F as R,o as F,i as k}from"./paginationfunction-cQwcg583.js";import{a as u}from"./cil-lock-locked-CYdsg60D.js";import{f as O}from"./index-b-rH6Afy.js";import{C as $,a as P,b as Y,c as V}from"./CModalTitle-DQifuASo.js";import{C as B,a as U,b as H,c as b}from"./DefaultLayout-BdiyXKQm.js";import{R as W}from"./FilePdfOutlined-BQFSH_p3.js";import{R as z}from"./CloudDownloadOutlined-EvAFct2Z.js";import{C as J}from"./CModalFooter-KGCUttOr.js";import{B as G}from"./button-B-GL0v4J.js";import{R as K}from"./FolderViewOutlined-aLIAzBZ6.js";import"./AntdIcon-p-8olrNo.js";import"./compact-item-CogaolUq.js";import"./index.esm-CDc6Ey47.js";const he=()=>{const[i,C]=a.useState([]),[E,g]=a.useState(!0),x=a.useRef();S.useReactToPrint({content:()=>x.current,documentTitle:"All Document Report",onBeforeGetContent:()=>{},onAfterPrint:()=>{}});const[m,_]=a.useState([]),[D,w]=a.useState();a.useEffect(()=>{d.get(`${n}/usercreation`).then(s=>{const o=s.data.data;_(o)}).catch(s=>{alert(s.message)})},[]);const L=()=>{d.get(`${n}/mis/userdoc`,{headers:{userid:D}}).then(s=>{const o=s.data.data;C(o),g(!1)}).catch(s=>{alert(s.message)})},[f,h]=a.useState(!1),[l,I]=a.useState({}),[p,N]=a.useState([]),[c,j]=a.useState("");a.useEffect(()=>{if(l!=null&&l.details)if(!c)N(l.details);else{const s=l.details.filter(o=>{var t;return(t=o==null?void 0:o.DTLS_FILE_NAME)==null?void 0:t.toLowerCase().includes(c==null?void 0:c.toLowerCase())});N(s)}},[l,c,E]);const v=async s=>{try{const o=await d.get(s,{responseType:"blob",withCredentials:!0}),t=window.URL.createObjectURL(new Blob([o.data])),r=document.createElement("a");r.href=t;const M=s.split("/").pop();r.setAttribute("download",M),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(t)}catch(o){console.error("Error downloading the file:",o)}},A=(s,o)=>{const t={FILE_ID:s,FILE_NAME:o,VIEW_YN:"Y",DOWNLOAD_YN:"N"};d({method:"post",url:`${n}/deshboard/totalViewDownloadCount`,data:t}).then(r=>{})},T=(s,o)=>{const t={FILE_ID:s,FILE_NAME:o,VIEW_YN:"N",DOWNLOAD_YN:"Y"};d({method:"post",url:`${n}/deshboard/totalViewDownloadCount`,data:t}).then(r=>{})},y=[{title:"TYPE",className:"dark_bg ",dataIndex:"DOC_CAT"},{title:"PROJECT NAME",className:"dark_bg ",dataIndex:"PROJECT_NAME"},{title:"BRANCH NAME",className:"dark_bg ",dataIndex:"BRANCH_NAME"},{title:"DEPARTMENT",className:"dark_bg ",dataIndex:"DEPT_NAME"},{title:"POLICY",className:"dark_bg ",dataIndex:"POLICY_NO"},{title:"DOCUMENT NAME",className:"dark_bg ",dataIndex:"FILE_NAME"},{title:"Action",className:"dark_bg ",render:(s,o)=>e.jsx("div",{className:"text-center",children:e.jsx(G,{style:{backgroundColor:"#347928",color:"#fff"},onClick:()=>{h(!f),I(o),j("")},shape:"circle",icon:e.jsx(K,{})})})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-start",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("select",{className:"form-select form-control bba_documents-form-control",onChange:s=>w(s.target.value),children:[e.jsx("option",{value:"",children:"Select Employee"}),(m==null?void 0:m.length)>0&&e.jsx(e.Fragment,{children:m.map((s,o)=>e.jsx("option",{value:s.EMPLOYEE_ID,children:s.NAME}))})]})}),e.jsx("div",{className:"col-sm-4  ms-2",children:e.jsxs(u,{style:{backgroundColor:"rgb(61, 54, 78)",color:"#fff"},onClick:()=>L(),children:[e.jsx(O,{})," Search"]})}),e.jsx("div",{className:"col-sm-4 "})]}),e.jsx("div",{className:"mt-4",ref:x,children:e.jsx("div",{className:"row ",children:e.jsx("div",{className:"col-md-12 ",children:e.jsx("div",{className:"table-responsive",children:e.jsx(R,{className:"table-striped",pagination:{total:i===void 0?0:i.length,showTotal:(s,o)=>`Showing ${o[0]} to ${o[1]} of ${s} entries`,showSizeChanger:!0,onShowSizeChange:F,itemRender:k},style:{overflowX:"auto"},columns:y,bordered:!0,dataSource:i===void 0?[]:i,rowKey:s=>s.COM_ID,onChange:console.log("change")})})})})})," ",l&&e.jsxs($,{visible:f,size:"lg",onClose:()=>h(!1),"aria-labelledby":"LiveDemoExampleLabel",children:[e.jsx(P,{onClose:()=>h(!1),children:e.jsx(Y,{id:"LiveDemoExampleLabel",style:{fontFamily:"Segoe UI"},children:"View Document Files"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-6",children:[" ",e.jsx("div",{className:"",children:e.jsxs("div",{className:"position-relative",style:{marginLeft:"30px",marginBottom:"10px"},children:[e.jsx("i",{className:"fa fa-search position-absolute",style:{left:"10px",top:"50%",transform:"translateY(-50%)",color:"#999"}}),e.jsx("input",{onChange:s=>{j(s.target.value)},className:"form-control w-100 shadow ps-4 ms-1",type:"text",placeholder:"Search Here",style:{paddingLeft:"35px"}})]})})]}),e.jsx("div",{className:"col-sm-6"})]}),e.jsx("div",{className:"row px-5 py-1",children:e.jsxs("table",{class:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bgColor",scope:"col",children:"#"}),e.jsx("th",{className:"bgColor",scope:"col",children:"File"}),e.jsx("th",{className:"bgColor",scope:"col",children:"Action"})]})}),e.jsx("tbody",{children:p==null?void 0:p.map((s,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:++o}),e.jsx("td",{children:s.DTLS_FILE_NAME?s.DTLS_FILE_NAME:" "}),e.jsxs("td",{children:[" ",e.jsxs(B,{className:"",children:[e.jsx(U,{style:{backgroundColor:"rgb(61, 54, 78)",color:"#fff"},children:"Action"}),e.jsxs(H,{children:[e.jsxs(b,{onClick:()=>{A(s.TRAN_DTL_ID,s.DTLS_FILE_NAME)},href:`${n}/static/public/image/${s==null?void 0:s.FILE_PATH}`,target:"_blank",children:[e.jsx(W,{})," View"]}),e.jsxs(b,{style:{cursor:"pointer"},onClick:()=>{v(`${n}/static/public/image/${s==null?void 0:s.FILE_PATH}`),T(s.TRAN_DTL_ID,s.DTLS_FILE_NAME)},children:[e.jsx(z,{})," Download"]})]})]})]})]},o))})]})}),e.jsx("div",{className:"submit-section",children:e.jsx(J,{className:"justify-content-center",style:{borderTop:"none"},children:e.jsx(u,{color:"secondary",onClick:()=>h(!1),children:"Close"})})})]})]})]})};export{he as default};
